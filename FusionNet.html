<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>FusionNet</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="모두의연구소 바이오메디컬랩 기술 블로그입니다." />
    <link rel="shortcut icon" href="http://localhost:4000/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="http://localhost:4000/FusionNet" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="바이오메디컬랩@모두의연구소" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="FusionNet" />
    <meta property="og:description" content="FusionNet FusionNet은 U-Net처럼 Semantic Segmentation에 활용 할 수 있는 모델입니다. 이름이 FusionNet인 이유는 아마도 Encoder에 있는 Layer를 가져와 Decoder에 결합(Fusion)하는 방법이 이 모델에 가장 특징적인 부분이기 때문인 것 같습니다. U-Net과 유사한 부분이 많기 때문에 블로그에 U-Net글을 읽으시면 많은 도움이 될 것 같습니다. U-Net (by 강은숙) FusionNet 이란? FusionNet은 Connectomics(뇌신경 연결지도를" />
    <meta property="og:url" content="http://localhost:4000/FusionNet" />
    <meta property="og:image" content="http://localhost:4000/assets/images/posts/2018-05-04-Fusion_Net/fusion-net_3.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2018-05-04T09:00:00+09:00" />
    <meta property="article:modified_time" content="2018-05-04T09:00:00+09:00" />
    <meta property="article:tag" content="논문 리뷰" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="FusionNet" />
    <meta name="twitter:description" content="FusionNet FusionNet은 U-Net처럼 Semantic Segmentation에 활용 할 수 있는 모델입니다. 이름이 FusionNet인 이유는 아마도 Encoder에 있는 Layer를 가져와 Decoder에 결합(Fusion)하는 방법이 이 모델에 가장 특징적인 부분이기 때문인 것 같습니다. U-Net과 유사한 부분이 많기 때문에 블로그에 U-Net글을 읽으시면 많은 도움이 될 것 같습니다. U-Net (by 강은숙) FusionNet 이란? FusionNet은 Connectomics(뇌신경 연결지도를" />
    <meta name="twitter:url" content="http://localhost:4000/" />
    <meta name="twitter:image" content="http://localhost:4000/assets/images/posts/2018-05-04-Fusion_Net/fusion-net_3.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="바이오메디컬랩@모두의연구소" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="논문 리뷰" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "바이오메디컬랩@모두의연구소",
        "logo": "http://localhost:4000/assets/images/blog-icon.png"
    },
    "url": "http://localhost:4000/FusionNet",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:4000/assets/images/posts/2018-05-04-Fusion_Net/fusion-net_3.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/FusionNet"
    },
    "description": "FusionNet FusionNet은 U-Net처럼 Semantic Segmentation에 활용 할 수 있는 모델입니다. 이름이 FusionNet인 이유는 아마도 Encoder에 있는 Layer를 가져와 Decoder에 결합(Fusion)하는 방법이 이 모델에 가장 특징적인 부분이기 때문인 것 같습니다. U-Net과 유사한 부분이 많기 때문에 블로그에 U-Net글을 읽으시면 많은 도움이 될 것 같습니다. U-Net (by 강은숙) FusionNet 이란? FusionNet은 Connectomics(뇌신경 연결지도를"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="FusionNet" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="http://localhost:4000/"><img src="/assets/images/blog-icon.png" alt="바이오메디컬랩@모두의연구소" /></a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">목록</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">소개</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-papers ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 4 May 2018">2018년 05월 04일</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/논문-리뷰/'>논문 리뷰</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">FusionNet</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/posts/2018-05-04-Fusion_Net/fusion-net_3.png)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <h1 id="fusionnet"><strong>FusionNet</strong></h1>

<p>FusionNet은 U-Net처럼 Semantic Segmentation에 활용 할 수 있는 모델입니다.</p>

<p>이름이 FusionNet인 이유는 아마도 Encoder에 있는 Layer를 가져와 Decoder에 결합(Fusion)하는 방법이 이 모델에 가장 특징적인 부분이기 때문인 것 같습니다.</p>

<p>U-Net과 유사한 부분이 많기 때문에 블로그에 U-Net글을 읽으시면 많은 도움이 될 것 같습니다. 
<a href="https://modulabs-biomedical.github.io/U_Net">U-Net (by 강은숙)</a></p>

<h3 id="fusionnet-이란">FusionNet 이란?</h3>

<p><strong>FusionNet</strong>은 Connectomics(뇌신경 연결지도를 작성하고 분석하는 신경과학의 일종) 데이터에서 신경구조를 Segmentation 할 목적으로 만든 딥러닝 모델입니다.</p>

<p>논문발표일(2016.12.26) 기준에서 최신의 기술인 Semantic Segmentation과 Residual Neural Networks를 사용 한 모델이라고 하네요.</p>

<p>이 논문에서는 FusionNet을 Electron Microscopy (EM) 이미지에서 Cell Membrane과 Cell Body의 Segmentation에 적용하였습니다.</p>

<h3 id="모델의-특징">모델의 특징</h3>

<p>이전에 connectomics에서 automatic image segmentation을 할 때 보통 <strong>CNN(Convolutional Neural Network)</strong>에 기반 한 <strong>patch-based pixel-wise classification</strong>을 사용했는데 EM 데이터가 용량이 상당히 크기 때문에 처리하기 위한 비용이 많이 들어간다는 문제가 있었습니다.</p>

<p>( 여기서 비용이란 딥러닝을 하기 위한 하드웨어 구입, 전기 사용, 시간 등을 말합니다. )</p>

<p>Encoding, Decoding을 사용한 <strong>FCN(fully Convolution Neural Network)</strong>계열의 모델의 경우 연산량을 줄일 수 있어 비용을 절감 할 수 있는데 이것에 대표적인 모델이 <strong>U-Net</strong>입니다.</p>

<p>하지만 <strong>U-Net</strong>의 방법이 데이터로부터 다중의 맥락 정보를 학습할 수 있지만 <strong>Gradient Vanising</strong> 문제가 발생하기 때문에 깊은 네트워크를 만드는 것은 제한적이었습니다.</p>

<p><strong>FusionNet</strong>은 <strong>residual layers</strong>와 <strong>summation-based skip connection</strong>을 사용하여 <strong>U-Net</strong>의 단점을 보완한 모델입니다.</p>

<p><strong>residual layer</strong></p>

<blockquote>
  <p>이전에 계산된 값을 뒷부분에도 연결시켜서 모델이 깊어져도 값을 잊어버리지 않게 해주는 역할을 함 (vanishing gradient 문제 해결)</p>
</blockquote>

<p><strong>summation-based skip connections</strong></p>

<blockquote>
  <p>층을 건너띄워서 연결, 건너띄워 넘어온 층과 이전의 층을 더해서(합계산) 뒤에 층으로 넘김</p>
</blockquote>

<h5 id="pytorch-code-예시-summation-based-skip-connections">Pytorch Code 예시 (summation-based skip connections)</h5>
<p><img src="../assets/images/posts/2018-05-04-Fusion_Net/fusion-net_1.png" alt="fusion-net_1" /></p>

<h4 id="u-net과-비교하여-가장-특징적인-차이">U-Net과 비교하여 가장 특징적인 차이</h4>

<p><strong>U-net</strong>에서는 긴 skip connection을 통해 feature map을 <strong>이어 붙임 (Concatenating)</strong> 
<strong>FusionNet</strong>에서는 긴 skip connection을 통해 feature map의 <strong>값을 더함</strong> + 짧은 skip connection도 encoding, decoding의 각 step에서 사용</p>

<p>이 방법이 실제로 좋은 퍼포먼스를 보여서 <strong>ISBI 2012 EM segmentation challenge</strong>에서 <strong>1등</strong> 했다고 합니다.
(물론 FusionNet이 100% 기여했다고 까지는 볼 수 없을 것 같습니다.)</p>

<p>OverFitting 해결을 위한 <strong>Data enrichment</strong> (이미지 데이터에 다양한 변형을 가하거나 노이즈를 추가하는 등의 방법을 사용)를 사용 한 것도 좋은 퍼포먼스를 내는데 도움이 되었을 것 입니다.</p>

<p><img src="../assets/images/posts/2018-05-04-Fusion_Net/fusion-net_2.png" alt="fusion-net_2" /></p>

<p>정말 U-Net보다 결과가 좋네요!!!</p>

<h3 id="모델-아키텍처">모델 아키텍처</h3>

<p><img src="../assets/images/posts/2018-05-04-Fusion_Net/fusion-net_3.png" alt="fusion-net_3" /></p>

<p><strong>Encoding Path</strong>	-&gt;	640X640부터 40X40 까지 the features of interest를 검출</p>

<p><strong>Decoding Path</strong>	-&gt;	40X40부터 640X640까지 synthesis를 예측</p>

<p><strong>녹색 블록</strong>	-&gt;	regular convolutional layer, ReLu 활성함수, batch normalization으로 구성</p>

<p><strong>보라색 블록</strong>	-&gt;	3개의 convolutional block으로 구성되는데 마지막 블록3에는 블록1이 블록2와 skip해서 더해진 residual layer가 연결 됨</p>

<p><strong>파란색 블록</strong>	-&gt;	maxpooling layer로써 encoding path에서 feature 압축을 위한 downsampling을 하기 위해 사용</p>

<p><strong>빨간색 블록</strong>	-&gt;	deconvolutional layer로 decoding path에서 interpolation을 사용한 upsampling을 하기 위해 사용</p>

<p><img src="../assets/images/posts/2018-05-04-Fusion_Net/fusion-net_4.png" alt="fusion-net_4" /></p>

<h3 id="참고자료">참고자료</h3>

<p><a href="https://arxiv.org/ftp/arxiv/papers/1612/1612.05360.pdf">FusionNet : A deep fully residual convolutional neural network for image segmentation in connectomics</a></p>

<p>이상으로 FusionNet에 대한 글을 마칩니다. 수정해야 할 내용이 있다면 꼭 말씀 부탁드립니다.
부족한 글이지만 끝까지 읽어주셔서 감사합니다!!!</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/kyungmo_kim.jpeg" alt="kyungmo_kim" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/kyungmo_kim">김경모</a></h4>
                                
                                    <p>딥러닝을 연구하고 있습니다.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/kyungmo_kim">Read More</a>
                        </div>
                    
                
                    
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>
	<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
	</script>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/blog-cover.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; 바이오메디컬랩@모두의연구소 &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/논문-리뷰/">논문 리뷰</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/U_Net">U-Net</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/Learning_Deconvolution_Network_for_Semantic_Segmentation">Learning Deconvolution Network for Semantic Segmentation</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/FCN">Fully Convolutional Networks for Semantic Segmentation</a></li>
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/논문-리뷰/">
                                
                                    See all 3 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/TensorPack">
                <div class="post-card-image" style="background-image: url(/assets/images/posts/2018-08-17-TensorPack/tensorpack.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/TensorPack">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">개념 정리</span>
                            
                        
                    

                    <h2 class="post-card-title">TensorPack</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>## Tensorpack 구조 이해하기 ###### ModelDesc와 Trainer를 중심으로 ###### Peter Cha #### Tensorpack을 공부하면, &#128528; * 우선 모르는 것들 투성이다. 알고나면 너무 쓰기 편하지만, 처음 접할 때는 너무 많이 추상화 된 API에 '이게</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/peter_cha.jpg" alt="차예솔" />
                        
                        <span class="post-card-author">
                            <a href="/author/peter_cha/">차예솔</a>
                        </span>
                    
                
                    
                
                    
                
                    
                
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/U_Net">
                <div class="post-card-image" style="background-image: url(/assets/images/posts/2018-04-02-U_Net/u-net.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/U_Net">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">논문 리뷰</span>
                            
                        
                    

                    <h2 class="post-card-title">U-Net</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>논문 링크 : U-Net: Convolutional Networks for Biomedical Image Segmentation 이번 블로그의 내용은 Semantic Segmentation의 가장 기본적으로 많이 쓰이는 모델인 U-Net에 대한 내용입니다. U-Net의 이름은 그 자체로 모델의 형태가 U자로 되어 있어서 생긴</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/eunsook_kang.jpg" alt="강은숙" />
                        
                        <span class="post-card-author">
                            <a href="/author/eunsook_kang/">강은숙</a>
                        </span>
                    
                
                    
                
                    
                
                    
                
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="http://localhost:4000/">
            
                <img src="/assets/images/favicon.png" alt="바이오메디컬랩@모두의연구소 icon" />
            
            <span>바이오메디컬랩@모두의연구소</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">FusionNet</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=FusionNet&amp;url=https://myJekyll.github.io/jasper2/FusionNet"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://myJekyll.github.io/jasper2/FusionNet"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://localhost:4000/">바이오메디컬랩@모두의연구소</a> &copy; 2018</section>
                <nav class="site-footer-nav">
                    <a href="/">최신글</a>
                    
                    
                    <a href="http://www.modulabs.co.kr" target="_blank" rel="noopener">모두의 연구소</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    

    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69281367-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
